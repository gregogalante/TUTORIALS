<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2024-01-02T19:19:34+01:00</updated><id>/feed.xml</id><title type="html">Tutorials</title><subtitle>The place where I write about my daily dev problems (and solutions ðŸ˜€).</subtitle><entry><title type="html">[IT] Blocco preventivo dei cookie tramite Iubenda</title><link href="/webdev/2024/01/01/blocco-preventivo-cookie-iubenda.html" rel="alternate" type="text/html" title="[IT] Blocco preventivo dei cookie tramite Iubenda" /><published>2024-01-01T00:00:00+01:00</published><updated>2024-01-01T00:00:00+01:00</updated><id>/webdev/2024/01/01/blocco-preventivo-cookie-iubenda</id><content type="html" xml:base="/webdev/2024/01/01/blocco-preventivo-cookie-iubenda.html"><![CDATA[<h2 id="wordpress">WORDPRESS</h2>

<ol>
  <li>
    <p>Installare il plugin <a href="https://wordpress.org/plugins/iubenda-cookie-solution/">Iubenda Cookie Solution</a> e attivarlo</p>
  </li>
  <li>
    <p>Modificare gli script javascript del sito in modo che vengano caricati solo dopo che il banner Ã¨ stato accettato (segui esempi qui sotto)</p>
  </li>
</ol>

<h3 id="script-che-caricano-codice-esterno">Script che caricano codice esterno</h3>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Prima --&gt;</span>
<span class="nt">&lt;script </span><span class="na">async</span> <span class="na">src=</span><span class="s">"https://www.googletagmanager.com/gtag/js?id=XXX"</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="c">&lt;!-- Dopo --&gt;</span>
<span class="nt">&lt;script </span><span class="na">async</span> <span class="na">class=</span><span class="s">"_iub_cs_activate"</span> <span class="na">type=</span><span class="s">"text/plain"</span> <span class="na">data-iub-purposes=</span><span class="s">"3"</span> <span class="na">data-suppressedsrc=</span><span class="s">"https://www.googletagmanager.com/gtag/js?id=XXX"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<h3 id="script-che-caricano-codice-inline">Script che caricano codice inline</h3>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Prima --&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span> <span class="o">||</span> <span class="p">[];</span>
  <span class="kd">function</span> <span class="nf">gtag</span><span class="p">(){</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);}</span>
  <span class="nf">gtag</span><span class="p">(</span><span class="dl">'</span><span class="s1">js</span><span class="dl">'</span><span class="p">,</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">());</span>
<span class="nt">&lt;/script&gt;</span>

<span class="c">&lt;!-- Dopo --&gt;</span>
<span class="nt">&lt;script </span><span class="na">class=</span><span class="s">"_iub_cs_activate-inline"</span> <span class="na">type=</span><span class="s">"text/plain"</span> <span class="na">data-iub-purposes=</span><span class="s">"3"</span><span class="nt">&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span> <span class="o">||</span> <span class="p">[];</span>
  <span class="kd">function</span> <span class="nf">gtag</span><span class="p">(){</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);}</span>
  <span class="nf">gtag</span><span class="p">(</span><span class="dl">'</span><span class="s1">js</span><span class="dl">'</span><span class="p">,</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">());</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="webdev" /><summary type="html"><![CDATA[WORDPRESS]]></summary></entry><entry><title type="html">[IT] Configurazione di Nginx su server Ubuntu 18+</title><link href="/sysadmin/2024/01/01/configurazione-nginx-ubuntu.html" rel="alternate" type="text/html" title="[IT] Configurazione di Nginx su server Ubuntu 18+" /><published>2024-01-01T00:00:00+01:00</published><updated>2024-01-01T00:00:00+01:00</updated><id>/sysadmin/2024/01/01/configurazione-nginx-ubuntu</id><content type="html" xml:base="/sysadmin/2024/01/01/configurazione-nginx-ubuntu.html"><![CDATA[<p>Dei seguito alcuni verranno presentati alcuni esempi delle principali tipologie di applicativi configurabili nel file /etc/nginx/site-available/default o su altri file nella stessa directory.</p>

<h2 id="sito-web-statico">SITO WEB STATICO</h2>

<pre><code class="language-txt">server {
  listen 80;
  server_name example.com; # dominio applicazione
  root /home/deploy/applications/APP_PATH/public; # directory applicazione
  index index.html;
}
</code></pre>

<h2 id="creare-un-upstream-per-gestire-diversi-applicativi-in-ascolto-sulla-porta-80">CREARE UN UPSTREAM PER GESTIRE DIVERSI APPLICATIVI IN ASCOLTO SULLA PORTA 80</h2>

<p>Quando il server deve gestire diverse applicazioni sulla porta 80 la soluzione consiste nel creare diversi proxy che, dato il dominio, eseguono un upstream di applicazioni in ascolto su altre porte.</p>

<p>Se, per esempio, avete una applicazione sulla porta 8001, per girare su di essa tutte le richieste con dominio servername.com basta inserire i segenti codici:</p>

<pre><code class="language-txt">upstream unique_upstream_name {
  server 127.0.0.1:8001; # localhost with application port
}

server {
  listen 80; # server host with 80 port
  server_name servername.com; # custom application domain
  location / {
    proxy_pass  http://unique_upstream_name;
    proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504;
    proxy_redirect off;
    proxy_buffering off;
    proxy_set_header        Host            $host;
    proxy_set_header        X-Real-IP       $remote_addr;
    proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
  }
}
</code></pre>

<h2 id="creare-un-redirect-da-http-a-https">CREARE UN REDIRECT DA HTTP A HTTPS</h2>

<pre><code class="language-txt">server {
  listen 80;
  server_name example.com;
  return 301 https://$server_name$request_uri;
}
</code></pre>]]></content><author><name></name></author><category term="sysadmin" /><summary type="html"><![CDATA[Dei seguito alcuni verranno presentati alcuni esempi delle principali tipologie di applicativi configurabili nel file /etc/nginx/site-available/default o su altri file nella stessa directory.]]></summary></entry><entry><title type="html">Mysql configuration on Ubuntu 18+</title><link href="/sysadmin/2024/01/01/install-and-configure-mysql-ubuntu.html" rel="alternate" type="text/html" title="Mysql configuration on Ubuntu 18+" /><published>2024-01-01T00:00:00+01:00</published><updated>2024-01-01T00:00:00+01:00</updated><id>/sysadmin/2024/01/01/install-and-configure-mysql-ubuntu</id><content type="html" xml:base="/sysadmin/2024/01/01/install-and-configure-mysql-ubuntu.html"><![CDATA[<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>mysql-server
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl start mysql.service
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mysql
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">ALTER</span> <span class="k">USER</span> <span class="s1">'root'</span><span class="o">@</span><span class="s1">'localhost'</span> <span class="n">IDENTIFIED</span> <span class="k">WITH</span> <span class="n">mysql_native_password</span> <span class="k">BY</span> <span class="s1">'password'</span><span class="p">;</span>
<span class="n">exit</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql_secure_installation
</code></pre></div></div>]]></content><author><name></name></author><category term="sysadmin" /><summary type="html"><![CDATA[sudo apt install mysql-server]]></summary></entry><entry><title type="html">[IT] Installare e configurare Lets Encrypt con Nginx</title><link href="/sysadmin/2024/01/01/installazione-e-configurazione-letsencrypt-su-nginx.html" rel="alternate" type="text/html" title="[IT] Installare e configurare Lets Encrypt con Nginx" /><published>2024-01-01T00:00:00+01:00</published><updated>2024-01-01T00:00:00+01:00</updated><id>/sysadmin/2024/01/01/installazione-e-configurazione-letsencrypt-su-nginx</id><content type="html" xml:base="/sysadmin/2024/01/01/installazione-e-configurazione-letsencrypt-su-nginx.html"><![CDATA[<h2 id="installare-certbot">Installare certbot</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>add-apt-repository ppa:certbot/certbot
<span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install </span>certbot
</code></pre></div></div>

<h2 id="creare-un-certificato-con-certbot">Creare un certificato con certbot</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>certbot certonly <span class="nt">-a</span> webroot <span class="nt">--webroot-path</span><span class="o">=</span>/APP_PUBLIC_PATH <span class="nt">-d</span> yourdomain.here
</code></pre></div></div>

<p>NOTE: /APP_PUBLIC_PATH corrisponde alla path pubblica dellâ€™applicazione. Durante questa fase certbot crea un file allâ€™interno della directory per verificare la proprietÃ  del dominio.</p>

<h2 id="aggiornarerinnovare-i-certificati-scaduti-con-certbot">Aggiornare/rinnovare i certificati scaduti con certbot</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>certbot renew <span class="nt">--dry-run</span>
</code></pre></div></div>

<h2 id="impostare-un-cron-di-auto-aggiornamento-dei-certificati">Impostare un cron di auto-aggiornamento dei certificati</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nano /etc/cron.d/certbot-custom

37 02 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> root certbot <span class="nt">-q</span> renew <span class="nt">--pre-hook</span><span class="o">=</span><span class="s2">"systemctl stop nginx"</span> <span class="nt">--post-hook</span><span class="o">=</span><span class="s2">"systemctl start nginx"</span>
</code></pre></div></div>

<h2 id="impostare-il-certificato-su-una-configurazione-nginx">Impostare il certificato su una configurazione nginx</h2>

<pre><code class="language-txt">server {
  listen 80;
  listen 443 ssl; # add listener on 443 path
  ssl_certificate /etc/letsencrypt/live/yourdomain.here/fullchain.pem; # add ssl certificate
  ssl_certificate_key /etc/letsencrypt/live/yourdomain.here/privkey.pem; # add ssl certificate key
  server_name example.com;
  passenger_enabled on;
  root /home/deploy/applications/APP_PATH/public;
  index index.html;
}
</code></pre>]]></content><author><name></name></author><category term="sysadmin" /><summary type="html"><![CDATA[Installare certbot]]></summary></entry><entry><title type="html">[IT] Installazione di Nginx e PM2 su server Ubuntu 18+</title><link href="/sysadmin/2024/01/01/installazione-nginx-pm2-ubuntu.html" rel="alternate" type="text/html" title="[IT] Installazione di Nginx e PM2 su server Ubuntu 18+" /><published>2024-01-01T00:00:00+01:00</published><updated>2024-01-01T00:00:00+01:00</updated><id>/sysadmin/2024/01/01/installazione-nginx-pm2-ubuntu</id><content type="html" xml:base="/sysadmin/2024/01/01/installazione-nginx-pm2-ubuntu.html"><![CDATA[<h2 id="creazione-di-un-utente-deploy">CREAZIONE DI UN UTENTE DEPLOY</h2>

<p>Per motivi di sicurezza Ã¨ una buona pratica utilizzare un utenza diversa da root per gestire le attivitÃ  di deploy degli applicativi allâ€™interno del server.</p>

<p>Per creare un utente deploy bisogna accedere con lâ€™utenza root ed eseguire i seguenti comandi:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>adduser deploy
gpasswd <span class="nt">-a</span> deploy <span class="nb">sudo</span>
</code></pre></div></div>

<p>Alla richiesta di inserire una password per lâ€™utente si consiglia di generare una password complessa.</p>

<p>Una volta completata lâ€™installazione uscire dal sistema operativo e rientrare utilizzando lâ€™utenza deploy appena creata.</p>

<h2 id="installazione-delle-dipendenze-del-sistema">INSTALLAZIONE DELLE DIPENDENZE DEL SISTEMA</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get upgrade
<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> git-core curl zlib1g-dev build-essential libssl-dev libreadline-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt1-dev libcurl4-openssl-dev libffi-dev
</code></pre></div></div>

<h2 id="mettere-in-sicurezza-il-server">METTERE IN SICUREZZA IL SERVER</h2>

<p>Per evitare accessi indesiderati tramite brute force, bisogna almeno impostare un sistema di ban dei tentativi falliti di connessione. Per farlo Ã¨ consigliata lâ€™installazione di fail2ban.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>fail2ban
</code></pre></div></div>

<p>Eventualmente personalizzare la configurazione di default per rendere il sistema piÃ¹ sicuro; per farlo bisogna seguire i seguenti comandi:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo cp</span> /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
<span class="nb">sudo </span>nano /etc/fail2ban/jail.local
</code></pre></div></div>

<h2 id="installare-nodejs">INSTALLARE NODE.JS</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-sL</span> https://deb.nodesource.com/setup_18.x <span class="nt">-o</span> nodesource_setup.sh
<span class="nb">sudo </span>bash nodesource_setup.sh
<span class="nb">sudo </span>apt <span class="nb">install </span>nodejs
</code></pre></div></div>

<h2 id="installare-nginx">INSTALLARE NGINX</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>nginx
</code></pre></div></div>

<h2 id="installare-pm2">INSTALLARE PM2</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">-g</span> pm2
</code></pre></div></div>

<h2 id="attivare-eliminazione-log-pm2">ATTIVARE ELIMINAZIONE LOG PM2</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab <span class="nt">-e</span>
</code></pre></div></div>

<pre><code class="language-txt">0 0 * * * rm -rf /home/deploy/.pm2/logs/*
</code></pre>]]></content><author><name></name></author><category term="sysadmin" /><summary type="html"><![CDATA[CREAZIONE DI UN UTENTE DEPLOY]]></summary></entry></feed>